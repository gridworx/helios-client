# =============================================================================
# Helios Client Portal - Environment Configuration
# =============================================================================
#
# VALIDATION: Environment variables are validated at startup using Joi.
# If validation fails, the application will exit with a clear error message.
#
# QUICK START:
#   1. Copy this file to .env
#   2. Update values marked with [CHANGE IN PRODUCTION]
#   3. Run: docker compose up -d
#   4. Access: http://localhost:80
#
# PRODUCTION DEPLOYMENT:
#   1. Copy this file to .env
#   2. Update ALL values marked [CHANGE IN PRODUCTION]
#   3. Run: docker compose -f docker-compose.prod.yml up -d
#   4. Configure DNS to point to your server
#   5. Access: https://your-domain.com
#
# LEGEND:
#   [REQUIRED]             - Must be set, no default
#   [REQUIRED IN PROD]     - Required only in production mode
#   [OPTIONAL]             - Has sensible default
#   [CHANGE IN PRODUCTION] - Update before going to production
#
# =============================================================================

# -----------------------------------------------------------------------------
# Public URL Configuration (IMPORTANT for remote access!) [OPTIONAL]
# -----------------------------------------------------------------------------
# PUBLIC_URL is used for generating links in emails and asset URLs.
# Leave EMPTY to use relative URLs (recommended for nginx proxy setup).
# Set to full URL for production with custom domain.
#
# Examples:
#   Development:  PUBLIC_URL=              (empty - uses relative URLs)
#   Production:   PUBLIC_URL=https://helios.example.com
PUBLIC_URL=

# Frontend URL (for CORS and email links) [OPTIONAL]
# Development:  http://localhost:3000 or http://localhost:80 (nginx)
# Production:   https://helios.example.com
FRONTEND_URL=http://localhost:80

# Additional Trusted Origins (for CORS and auth) [OPTIONAL]
# Comma-separated list of additional URLs to allow.
# Use this when accessing from a different IP/hostname.
# Example: TRUSTED_ORIGINS=http://192.168.1.100,http://myserver.local
TRUSTED_ORIGINS=

# Application URL (for password setup links in emails) [OPTIONAL]
APP_URL=http://localhost:80

# -----------------------------------------------------------------------------
# HTTPS / SSL Configuration (Production)
# -----------------------------------------------------------------------------
# For HTTPS, set NGINX_CONFIG to use the production nginx config:
#   NGINX_CONFIG=nginx.prod.conf
#
# Place SSL certificates in nginx/ssl/:
#   nginx/ssl/cert.pem      (certificate)
#   nginx/ssl/key.pem       (private key)
#
# Or use Let's Encrypt (see nginx/nginx.prod.conf for certbot paths)
#
# Port configuration:
#   HTTP_PORT=80            (default, redirects to HTTPS in prod)
#   HTTPS_PORT=443          (default)
NGINX_CONFIG=nginx.conf
HTTP_PORT=80
HTTPS_PORT=443

# -----------------------------------------------------------------------------
# Backend Configuration [OPTIONAL]
# -----------------------------------------------------------------------------
# NODE_ENV: development | production | test (default: development)
NODE_ENV=development
# PORT: Backend server port (default: 3001)
PORT=3001

# Rate Limiting (disable for development/testing if needed)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# Database Configuration [REQUIRED] [CHANGE IN PRODUCTION]
# -----------------------------------------------------------------------------
DB_HOST=localhost
DB_PORT=5432
DB_NAME=helios_client
DB_USER=postgres
# DB_PASSWORD: [REQUIRED IN PROD] Must be at least 8 characters in production
DB_PASSWORD=postgres

# -----------------------------------------------------------------------------
# Redis Configuration [OPTIONAL]
# -----------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# S3-Compatible Storage Configuration
# These credentials work for both self-hosted MinIO AND cloud providers (AWS S3, Cloudflare R2, etc.)
# For self-hosted: MinIO automatically uses these credentials
# For cloud: Change endpoint and use provider's credentials

# Self-Hosted MinIO (default)
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin123
S3_BUCKET_PRIVATE=helios-uploads
S3_BUCKET_PUBLIC=helios-public
S3_REGION=us-east-1
S3_USE_SSL=false
S3_PUBLIC_URL=http://localhost:9000

# Cloud Provider Examples (comment out above, uncomment below):
# AWS S3:
#   S3_ENDPOINT=https://s3.amazonaws.com
#   S3_ACCESS_KEY=your-aws-access-key-id
#   S3_SECRET_KEY=your-aws-secret-key
# Cloudflare R2:
#   S3_ENDPOINT=https://your-account.r2.cloudflarestorage.com
#   S3_ACCESS_KEY=your-r2-access-key
#   S3_SECRET_KEY=your-r2-secret-key
# DigitalOcean Spaces:
#   S3_ENDPOINT=https://nyc3.digitaloceanspaces.com
#   S3_ACCESS_KEY=your-spaces-key
#   S3_SECRET_KEY=your-spaces-secret

# -----------------------------------------------------------------------------
# Security Configuration [REQUIRED IN PROD] [CHANGE IN PRODUCTION]
# -----------------------------------------------------------------------------
# Generate secure random strings for production:
#   openssl rand -hex 32
# JWT_SECRET: [REQUIRED IN PROD] Must be at least 32 characters in production
JWT_SECRET=your-super-secret-jwt-key-change-this
JWT_EXPIRES_IN=8h
REFRESH_TOKEN_EXPIRES_IN=7d

# Encryption Keys (32+ characters, for service account credentials)
# Generate: openssl rand -hex 32
# ENCRYPTION_KEY: [REQUIRED IN PROD] Must be at least 32 characters
ENCRYPTION_KEY=your-32-character-encryption-key-here-change-this
# EMAIL_ENCRYPTION_KEY: [REQUIRED IN PROD] Must be at least 32 characters
EMAIL_ENCRYPTION_KEY=your-32-character-email-encryption-key-change-this

# -----------------------------------------------------------------------------
# Passkey / WebAuthn Configuration [OPTIONAL]
# -----------------------------------------------------------------------------
# Passkeys enable passwordless authentication using biometrics, hardware keys,
# or device authentication (Touch ID, Face ID, Windows Hello, YubiKey, etc.)
#
# PASSKEY_RP_ID: Relying Party ID - typically your domain (no protocol)
#   Development: localhost
#   Production: your-domain.com (must match where users register passkeys)
#
# PASSKEY_ORIGIN: The full origin URL for passkey authentication
#   Development: http://localhost:3000 or http://localhost:80
#   Production: https://your-domain.com
#
# IMPORTANT: Once users register passkeys, changing these values will
# invalidate existing registrations! Plan your domain before enabling.
#
PASSKEY_RP_ID=localhost
PASSKEY_ORIGIN=http://localhost:80

# -----------------------------------------------------------------------------
# SMTP Configuration (for password setup emails) [OPTIONAL]
# -----------------------------------------------------------------------------
# Leave empty to use organization-specific SMTP settings from database
SMTP_HOST=
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASS=
SMTP_FROM=noreply@helios.com
SMTP_FROM_NAME=Helios Admin Portal

# Theme Configuration [OPTIONAL]
# Available themes:
#  - helios-purple (Default) - Original Helios purple gradient
#  - corporate-blue - Professional, trustworthy, and calm
#  - sophisticated-purple - Modern, sophisticated, and focused
#  - helios-dark - Sleek dark mode with purple accents
#  - google-blue - Google Workspace inspired blue
#  - modern-teal - Fresh modern teal
#  - default - Soft purple variant
VITE_DEFAULT_THEME=helios-purple

# Google Workspace Integration
# NOTE: Do NOT configure Google Workspace credentials here!
# Configure through Helios UI: Settings > Modules > Google Workspace
# Credentials are stored encrypted in the database per organization

# -----------------------------------------------------------------------------
# Background Jobs Configuration [OPTIONAL]
# -----------------------------------------------------------------------------
# Enable/disable and configure background jobs

# Scheduled Actions (user lifecycle automation)
SCHEDULED_ACTIONS_ENABLED=true
SCHEDULED_ACTIONS_INTERVAL_MS=60000
SCHEDULED_ACTIONS_BATCH_SIZE=10
SCHEDULED_ACTIONS_MAX_RETRIES=3

# Signature Sync Job (Gmail signature deployment)
SIGNATURE_SYNC_JOB_ENABLED=true
SIGNATURE_SYNC_INTERVAL_MS=300000
SIGNATURE_SYNC_BATCH_SIZE=50
SIGNATURE_DETECT_EXTERNAL_CHANGES=false

# Campaign Scheduler (signature campaign lifecycle)
CAMPAIGN_SCHEDULER_ENABLED=true
CAMPAIGN_SCHEDULER_INTERVAL_MS=60000

# -----------------------------------------------------------------------------
# Telemetry Configuration [OPTIONAL]
# -----------------------------------------------------------------------------
# Anonymous usage data sent to helios.gridworx.io to improve the product.
# Disabled by default. Enable to help prioritize feature development.
# See: https://helios.gridworx.io/insights for public usage dashboard.
#
# What we collect (anonymized):
#   - Instance ID (random, not tied to org)
#   - Version number
#   - User count range (1-10, 11-50, etc.)
#   - Enabled modules
#   - API relay usage counts
#   - Command usage counts
#
# What we NEVER collect:
#   - Organization name or domain
#   - User names, emails, or PII
#   - API request/response content
#   - Google Workspace credentials
#
HELIOS_TELEMETRY_ENABLED=false
HELIOS_TELEMETRY_URL=https://helios.gridworx.io/api/instances/heartbeat
# HELIOS_LICENSE_KEY: Optional license key for hosted instances
# HELIOS_LICENSE_KEY=

# -----------------------------------------------------------------------------
# Security Audit Logging [OPTIONAL]
# -----------------------------------------------------------------------------
# Automatic API request logging for compliance and security monitoring.
# This uses a three-layer approach:
#   1. Middleware: Logs all mutating API requests with actor context from JWT
#   2. Route handlers: Add semantic context (enrichment) where needed
#   3. Database triggers: Capture exact data changes as safety net
#
# AUDIT_LOGGING_ENABLED: Enable/disable audit middleware (default: true)
# When enabled, all POST/PUT/PATCH/DELETE requests are logged to security_audit_logs
# with tamper-evident hash chains for compliance.
AUDIT_LOGGING_ENABLED=true

# -----------------------------------------------------------------------------
# Logging Configuration [OPTIONAL]
# -----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_FILE=logs/helios.log